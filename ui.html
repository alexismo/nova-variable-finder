<!-- VariableID:1:335 -->

<style>
  /* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0 | 20110126
   License: none (public domain)
*/

  html,
  body,
  div,
  span,
  applet,
  object,
  iframe,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  p,
  blockquote,
  pre,
  a,
  abbr,
  acronym,
  address,
  big,
  cite,
  code,
  del,
  dfn,
  em,
  img,
  ins,
  kbd,
  q,
  s,
  samp,
  small,
  strike,
  strong,
  sub,
  sup,
  tt,
  var,
  b,
  u,
  i,
  center,
  dl,
  dt,
  dd,
  ol,
  ul,
  li,
  fieldset,
  form,
  label,
  legend,
  table,
  caption,
  tbody,
  tfoot,
  thead,
  tr,
  th,
  td,
  article,
  aside,
  canvas,
  details,
  embed,
  figure,
  figcaption,
  footer,
  header,
  hgroup,
  menu,
  nav,
  output,
  ruby,
  section,
  summary,
  time,
  mark,
  audio,
  video {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
  }

  /* HTML5 display-role reset for older browsers */
  article,
  aside,
  details,
  figcaption,
  figure,
  footer,
  header,
  hgroup,
  menu,
  nav,
  section {
    display: block;
  }

  body {
    line-height: 1;
  }

  ol,
  ul {
    list-style: none;
  }

  blockquote,
  q {
    quotes: none;
  }

  blockquote:before,
  blockquote:after,
  q:before,
  q:after {
    content: "";
    content: none;
  }

  table {
    border-collapse: collapse;
    border-spacing: 0;
  }
  @import url("https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap");

  body {
    font-size: 11px;
    background-color: var(--figma-color-bg);
    color: var(--figma-color-text);
    text-align: center;
    font-family: "Inter", serif;
    font-optical-sizing: auto;
    font-weight: 450;
    font-style: normal;
    height: fit-content;
    font-feature-settings: "liga", "calt";
  }

  nav {
    padding: 1rem 1rem;
    margin: 0;
    text-align: left;
    height: 1.5rem;
  }

  svg {
    height: 100%;
  }

  main {
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 1rem;
  }

  h1, h2 {
    font-size: 11px;
    font-weight: 550;
    color: var(--figma-color-text);
    text-align: left;
  }

  h2 {
    margin-bottom: 12px;
  }

  input {
    display: flex;
    width: 100%;
    padding: 4px;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    align-self: stretch;
    border-radius: 4px;
    background: var(--figma-color-bg-hover);
    color: var(--figma-color-text);
    box-shadow: none;
    border: 1px solid transparent;
    font-size: 11px;
  }

  input:focus-visible {
    border: 1px solid var(--figma-color-border-brand);
    outline: none;
  }

  button {
    display: inline-flex;
    width: fit-content;
    padding: 12px;
    justify-content: center;
    align-items: center;
    border-radius: 6px;
    background: var(--figma-color-bg-brand);
    color: var(--figma-color-text-onbrand);
    font-size: 11px;
    font-weight: 500;
    box-shadow: none;
    border: 0;
    margin-top: 12px;
  }

  button:disabled {
    background: var(--figma-color-bg-disabled);
    cursor: not-allowed;
    color: var(--figma-color-text-ondisabled);
  }

  .footer {
    position: fixed;
    padding: 12px 0px;
    bottom: 0px;
    left: 0px;
    right: 0px;
    text-align: center;
    font-size: 11px;
    color: var(--figma-color-text-secondary);
    background-color: var(--figma-color-bg);
  }
  .footer a {
    color: var(--figma-color-text-brand);
  }

  .heart {
    color: var(--figma-color-icon-danger);
  }

  .results-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-top: 1rem;
    padding-bottom: 32px;
  }

  .result-item {
    text-align: left;
    padding: 8px;
    border: 1px solid var(--figma-color-border);
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s;
  }

  .result-item:hover {
    background-color: var(--figma-color-bg-hover);
  }

  .no-results {
    color: var(--figma-color-text-secondary);
    text-align: left;
    margin-top: 1rem;
  }

  .loading {
    display: inline-block;
    width: 1rem;
    height: 1rem;
    border: 2px solid var(--figma-color-text-onbrand);
    border-radius: 50%;
    border-top-color: transparent;
    animation: spin 1s linear infinite;
  }

  .loading-text {
    color: var(--figma-color-text-secondary);
    text-align: left;
    margin-top: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .loading-text::before {
    content: "";
    display: inline-block;
    width: 1rem;
    height: 1rem;
    border: 2px solid var(--figma-color-border-brand);
    border-radius: 50%;
    border-top-color: transparent;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }
</style>
<nav>
  <svg viewBox="0 0 143 40" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path
      d="M25.7127 2.1308L20.632 13.5191C20.2401 14.3957 20.2473 15.4375 20.7652 16.2478C21.5096 17.4171 22.96 17.8393 24.1844 17.3217L38.4492 11.3201L35.307 9.05301L24.421 13.7129C24.2719 13.7776 24.119 13.6214 24.187 13.4737L28.525 4.15985L25.7127 2.1308Z"
      fill="#F0801A"
    />
    <path
      d="M4.28535 10.0007L13.5038 18.3987C14.2132 19.0459 15.2045 19.3661 16.1365 19.1286C17.4803 18.7888 18.3364 17.5442 18.2291 16.2192L17.0075 0.791626L13.8688 3.06358L14.8769 14.8619C14.8916 15.0238 14.6953 15.12 14.5764 15.0091L7.09447 7.96729L4.28535 10.0007Z"
      fill="#F0801A"
    />
    <path
      d="M26.9543 39.1537L24.3687 26.9545C24.1703 26.0149 23.5521 25.1764 22.6567 24.8255C21.3671 24.3172 19.9456 24.8284 19.2595 25.967L11.249 39.2084L15.1237 39.1949L21.1898 29.0254C21.2723 28.8853 21.4879 28.9218 21.5197 29.0812L23.4865 39.1658L26.9543 39.1537Z"
      fill="#F0801A"
    />
    <path
      d="M4.85436 32.7601L15.6787 26.5682C16.5125 26.092 17.1219 25.247 17.1822 24.2872C17.2718 22.9039 16.3504 21.7068 15.0566 21.4018L0 17.8238L1.19761 21.5087L12.7349 24.1747C12.8935 24.2105 12.9247 24.4269 12.7826 24.5059L3.78249 29.4621L4.85436 32.7601Z"
      fill="#F0801A"
    />
    <path
      d="M40 20.1097L27.6029 18.7615C26.6483 18.657 25.6588 18.9828 25.0461 19.7241C24.161 20.7909 24.2034 22.3009 25.0712 23.3079L35.1537 35.0486L36.3493 31.3631L28.579 22.4278C28.4717 22.3057 28.5736 22.1122 28.735 22.1317L38.9299 23.4083L40 20.1097Z"
      fill="#F0801A"
    />
    <path
      d="M131.398 9.07996C134.091 9.07996 136.398 9.99996 138.318 11.84V9.59996H142.478V30.4H138.318V28.16C136.398 30 134.091 30.92 131.398 30.92C128.491 30.92 126.051 29.88 124.078 27.8C122.131 25.7466 121.158 23.1466 121.158 20C121.158 16.8533 122.131 14.2533 124.078 12.2C126.051 10.12 128.491 9.07996 131.398 9.07996ZM131.838 13.24C130.051 13.24 128.545 13.8933 127.318 15.2C126.091 16.4533 125.478 18.0533 125.478 20C125.478 21.92 126.091 23.5333 127.318 24.84C128.571 26.12 130.078 26.76 131.838 26.76C133.651 26.76 135.171 26.12 136.398 24.84C137.625 23.5333 138.238 21.92 138.238 20C138.238 18.0533 137.625 16.4533 136.398 15.2C135.171 13.8933 133.651 13.24 131.838 13.24Z"
      fill="var(--figma-color-text)"
    />
    <path
      d="M107.237 30.4L98.4766 9.59998H102.757L109.197 25.08L115.597 9.59998H119.877L111.117 30.4H107.237Z"
      fill="var(--figma-color-text)"
    />
    <path
      d="M86.2188 30.92C83.0988 30.92 80.4988 29.88 78.4188 27.8C76.3388 25.72 75.2988 23.12 75.2988 20C75.2988 16.88 76.3388 14.28 78.4188 12.2C80.4988 10.12 83.0988 9.07996 86.2188 9.07996C89.3388 9.07996 91.9388 10.12 94.0188 12.2C96.1254 14.28 97.1788 16.88 97.1788 20C97.1788 23.12 96.1254 25.72 94.0188 27.8C91.9388 29.88 89.3388 30.92 86.2188 30.92ZM86.2188 26.76C88.1388 26.76 89.7121 26.12 90.9388 24.84C92.2188 23.5333 92.8588 21.92 92.8588 20C92.8588 18.08 92.2188 16.48 90.9388 15.2C89.7121 13.8933 88.1388 13.24 86.2188 13.24C84.3521 13.24 82.7788 13.8933 81.4988 15.2C80.2454 16.5066 79.6188 18.1066 79.6188 20C79.6188 21.8933 80.2454 23.5066 81.4988 24.84C82.7788 26.12 84.3521 26.76 86.2188 26.76Z"
      fill="var(--figma-color-text)"
    />
    <path
      d="M52 30.4V9.59996H56.16V12.64C57.68 10.2666 59.96 9.07996 63 9.07996C65.4 9.07996 67.3733 9.85329 68.92 11.4C70.4933 12.9733 71.28 14.92 71.28 17.24V30.4H67.12V18.44C67.12 16.8933 66.6133 15.6133 65.6 14.6C64.5867 13.56 63.3067 13.04 61.76 13.04C60.16 13.04 58.8267 13.56 57.76 14.6C56.6933 15.64 56.16 16.9333 56.16 18.48V30.4H52Z"
      fill="var(--figma-color-text)"
    />
  </svg>
</nav>
<main>
  <h1>Find nodes by variable id or name</h1>
  <input
    id="nodeId"
    type="text"
    placeholder="e.g. VariableID:1:335 or variable/name"
  />
  <button id="findButton">Find Nodes</button>
  <div id="resultsList" class="results-list"></div>
  <div class="footer">
    <p>
      Made with <span class="heart">❤️</span> by the
      <a href="https://nova.eliagroup.io">Nova Team</a>
    </p>
  </div>
</main>
<script>
  const findButton = document.getElementById("findButton");
  const nodeIdInput = document.getElementById("nodeId");
  const resultsList = document.getElementById("resultsList");

  findButton.onclick = () => {
    const variable = nodeIdInput.value;

    // Show loading state
    findButton.disabled = true;
    findButton.innerHTML = "Searching...";
    resultsList.innerHTML =
      '<div class="loading-text">Searching for nodes...</div>';

    parent.postMessage(
      { pluginMessage: { type: "find-variable-nodes", id: variable } },
      "*"
    );
  };

  window.onmessage = (event) => {
    const message = event.data.pluginMessage;

    if (message.type === "variableResults") {
      // Reset button state
      findButton.disabled = false;
      findButton.innerHTML = "Find Nodes";

      if (message.nodes.length === 0) {
        resultsList.innerHTML =
          '<div class="no-results">No nodes found using this variable</div>';
        return;
      }

      resultsList.innerHTML = `<h2>We found ${message.nodes.length} nodes using this variable</h2>`;
      message.nodes.forEach((node, index) => {
        const nodeName = node.name.split(" > ").pop();
        const item = document.createElement("div");
        item.className = "result-item";
        item.textContent = `${index + 1}. Variable used in: ${nodeName}`;
        item.onclick = () => {
          parent.postMessage(
            { pluginMessage: { type: "select", id: node.id } },
            "*"
          );
        };
        resultsList.appendChild(item);
      });
    }
  };
</script>
